<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no">
    <title>贊助商品</title>
    @@include('./template/CDN.html')
</head>
<body class="shopContainerAll">
    <!-------------------- 頁首(計分板+導覽列) -------------------->
    @@include('template/header.html')
    @@include('template/login.html')
    <script src='js/shop.js'></script>
    <!-- <script src="js/starsShine.js"></script> -->
    
<!--------------------內容----------------------->

<section class="shopContainer">  
<!-- --------------------服裝道具---------------------- -->
    
    <div class="shoptitle">
        <h2>贊助候選人</h2>
    </div>


 <div id="shopBlack" style="display:none;">
    <div id="shopLightBox" style="display:none;"> 
        <div class="shopAlert">
            <p>系統訊息</p>
        </div>
        <div class="shopAlertBtn">
        <span>確定要購買此項道具?</span>  
        <button id="addToBackpack">確認</button>
        <button id="addToBackpack2">確認</button>
        <button id="addToBackpack3">確認</button>
        <button id="addToBackpack4">確認</button>
        <button id="Cancelbtn">取消</button>
        </div>
    </div>
 </div>
    <div id="boxForDisappear">        
        <div class="toolTitle02">
            <h2>
                服裝道具
            </h2>
            <span>
                購買服裝道具可以增加候選人支持度
            </span>
        </div>
        <div id="productBox" class="productBox">
            <div class="model">   
                <canvas id="myCanvas" width="400" height="600">     
                </canvas>
                <img class="rabbitPic" src="img/rabbit.png" alt="">    
            </div>      
            <div class="boxForProduct">
                <!-- <div class="toolTitle">
                    <h3>
                        服裝道具
                    </h3>
                    <span>
                        購買服裝道具可以增加候選人支持度
                    </span>
                </div>
                    <div class="col-6">
                            <div class="productPic">
                                <img id="shopPic1" src="img/shopPic1.png" width="128" onclick="loadImage01()"/>
                                
                            </div>
                            <div class="productTitle">
                                <h3>
                                聰明棒球帽
                                </h3>
                                <div  class="productBtn">
                                    <button id="shopSpanLogin" >$100</button>
            
                                </div>
                            </div>  
                    </div>
                    <div class="col-6">
                        <div class="productPic">
                                <img id="shopPic2" src="img/shopPic2.png" width="128" onclick="loadImage02()"/>
                        </div>
                        <div class="productTitle">
                            <h3>親和力面具</h3>
                            <div class="productBtn">
                                <button id="shopSpanLogin" >$100</button>
                            </div>
                        </div>  
                    </div>    
                    <div class="col-6">
                        <div class="productPic">
                                <img id="shopPic3" src="img/shopPic3.png" width="128" onclick="loadImage03()"/>
                        </div>
                        <div class="productTitle">
                            <h3>口才大聲公</h3>
                            <div  class="productBtn">
                                <button id="shopSpanLogin" >$100</button>
                            </div>
                            </div>  
                    </div>
                    <div class="col-6">
                        <div class="productPic">
                                <img id="shopPic4" src="img/shopPic4.png" width="128" onclick="loadImage04()"/>
                        </div>
                        <div  class="productTitle">
                            <h3>人氣氣球</h3>
                            <div class="productBtn">
                                <button id="shopSpanLogin" >$100</button>
                            </div>
                        </div>  
                    </div> -->
            </div> 
        </div> 
    </div>
      <!-- -------------------新聞道具區-------------------  -->
    
      <div class="fakeNewsLanuch container">
            <div class="toolTitle03">
                    <h2>
                        新聞集錦
                    </h2>
                    <span>
                        購買新聞道具之後可以張貼至討論區，經由玩家案讚或按噓，候選人的支持度就會增加或減少
                    </span>
                </div>
               
            <form method="POST" action="fakeNewsLanuch.php">
                <p>使用對象：
                    <label for="planetA">星球A</label>
                    <input type="radio" name="planet" id="planetA">
                    <label for="planetB">星球B</label>
                    <input type="radio" name="planet" id="planetB">
                    <label for="planetC">星球C</label>
                    <input type="radio" name="planet" id="planetC">
                </p>
                <p>支持度基礎值：
                    <select>
                        <option>請選擇</option>
                        <option>200</option>
                        <option>100</option>
                        <option>50</option>
                        <option>-50</option>
                        <option>-100</option>
                        <option>-200</option>
                    </select>
                </p>
                <p>新聞標題：<input type="text" maxlength="20" placeholder="最多輸入10個中文字"></p>
                <p>新聞內容：<textarea maxlength="240" placeholder="最多輸入120個中文字"></textarea></p>
                <button type="submit">送出(<span>$100</span>)</button>
            </form>
        </div>             
        <div class="clearboth"></div>
 <!-- -------------------扭蛋區------------------ -->
        <div class="toolTitle04">
            <h2>
                事件扭蛋機
            </h2>
            <span>
                玩家可以花費$100宇宙幣抽出隨機事件,可以增加或減少候選人支持度
            </span> 
        </div>
        <div class="eventgashapon">
            <div class="boxForEvent">
                <div id="trashLightBox" class="trash" style="display:none;"><!---扭蛋事件燈箱-->  
                </div> 
                <button id="trashLightBoxBtn" style="display:none;">
                    <p>確認</p>
                </button> 
            </div>  
            <div id="event02" class="gashapon">  <!--扭蛋動態----->
                <img class="gashaponPic" src="img/gashapon/empty.png" alt="">
            
                    <div class="gashaponPic01">
                        <img src="img/gashapon/blue.png" alt="">
                    </div>
                    <div class="gashaponPic02">
                        <img src="img/gashapon/red.png" alt="">
                    </div>
                    <div class="gashaponPic03">
                        <img src="img/gashapon/orange.png" alt="">
                    </div>
                    <div class="gashaponPic04">
                        <img src="img/gashapon/green.png" alt="">
                    </div>
                    <div class="gashaponPic05">
                        <img src="img/gashapon/pink.png" alt="">
                    </div>
                    <div class="gashaponPic06">
                        <img src="img/gashapon/navy.png" alt="">
                    </div>
                    <div class="gashaponPic07">
                        <img src="img/gashapon/yellow.png" alt="">
                    </div>
                    
            </div>    
               
                <div id="shopBlack1" style="display:none;">  
                    <div id="gashaponLightBox" style="display:none;"> 
                        <div class="shopAlert1">
                            <p>系統訊息</p>
                        </div> 
                        <div class="shopAertBtn1">
                            <span>確定要花費$100購買事件扭蛋嗎?</span> 
                            <button id="gashaponEvent">確認</button>
                            <button id="cancelEvent">取消</button>
                        </div>
                    </div>
                </div>  
            <div id="gashaponBtn" class="boxfora">  <!---觸發按鈕-->
                <a id="eventButton">按下去</a>   
            </div>
        </div>  <!---event-->   

</section>      
    <canvas id="starShine"></canvas>
    <!-------------------- 頁尾 -------------------->
    @@include('template/footer.html')
    <script src="js/login.js"></script>
    <script src="js/starsShine.js"></script>
  
    <!-- <script src="js/script.js"></script> -->
    
    <script>
         // 今日商品上架
         function shopEqui(){
      var xhr = new XMLHttpRequest();
      xhr.onload=function (){
           if( xhr.status == 200 ){
            shopEqui= JSON.parse(xhr.responseText);
            console.log(shopEqui[1][0].popularity);
                $(".boxForProduct").append(`
                <div class="toolTitle">
                    <!-- <h3>
                        服裝道具
                    </h3>
                    <span>
                        購買服裝道具可以增加候選人支持度
                    </span> -->
                    <span class="shopPopularity" style="visibility:hidden">${shopEqui[1][0].popularity}</span>
                </div>
                    <div class="col-6">
                            <div class="productPic">
                                <img id="shopPic1" src="${shopEqui[0][0].clothimg}" width="128" onclick="loadImage01()"/>
                                
                            </div>
                            <div class="productTitle">
                                <h3 class="clothName1">${shopEqui[0][0].clothName}</h3>
                                <div  class="productBtn1">
                                    <button id="shopSpanLogin" >${shopEqui[0][0].clothPrice}</button>
                                    <span class="popularityAdd1" style="visibility:hidden">${shopEqui[0][0].popularAmount}</span>                         
                                    <span class="clothNo1" style="visibility:hidden">${shopEqui[0][0].clothNo}</span>
                                    <span class="clothClass1" style="visibility:hidden">${shopEqui[0][0].clothClass}</span>
                                </div>
                            </div>  
                    </div>
                    <div class="col-6">
                        <div class="productPic">
                                <img id="shopPic2" src="${shopEqui[0][1].clothimg}" width="128" onclick="loadImage02()"/>
                        </div>
                        <div class="productTitle">
                            <h3 class="clothName2">${shopEqui[0][1].clothName}</h3>
                            <div class="productBtn2">
                                <button id="shopSpanLogin" >${shopEqui[0][1].clothPrice}</button>
                                <span class="popularityAdd2" style="visibility:hidden">${shopEqui[0][1].popularAmount}</span>    
                                <span class="clothNo2" style="visibility:hidden">${shopEqui[0][1].clothNo}</span>
                                <span class="clothClass2" style="visibility:hidden">${shopEqui[0][1].clothClass}</span>
                            </div>
                        </div>  
                    </div>    
                    <div class="col-6">
                        <div class="productPic">
                                <img id="shopPic3" src="${shopEqui[0][2].clothimg}" width="128" onclick="loadImage03()"/>
                        </div>
                        <div class="productTitle">
                            <h3 class="clothName3">${shopEqui[0][2].clothName}</h3>
                            <div  class="productBtn3">
                                <button id="shopSpanLogin" >${shopEqui[0][2].clothPrice}</button>
                                <span class="popularityAdd3" style="visibility:hidden">${shopEqui[0][2].popularAmount}</span>    <span class="clothNo3" style="visibility:hidden">${shopEqui[0][2].clothNo}</span>
                                <span class="clothClass3" style="visibility:hidden">${shopEqui[0][2].clothClass}</span>
                            </div>
                            </div>  
                    </div>
                    <div class="col-6">
                        <div class="productPic">
                                <img id="shopPic4" src="${shopEqui[0][3].clothimg}" width="128" onclick="loadImage04()"/>
                        </div>
                        <div  class="productTitle">
                            <h3 class="clothName4">${shopEqui[0][3].clothName}</h3>
                            <div class="productBtn4">
                                <button id="shopSpanLogin" >${shopEqui[0][3].clothPrice}</button>
                                <span class="popularityAdd4" style="visibility:hidden">${shopEqui[0][3].popularAmount}</span>    
                                <span class="clothNo4" style="visibility:hidden">${shopEqui[0][3].clothNo}</span>
                                <span class="clothClass4" style="visibility:hidden">${shopEqui[0][3].clothClass}</span>
                            </div>
                        </div>  
                    </div>
                `)
                //  console.log (e.target.parentNode.getAttribute("data-range"));  
            }

      }
      
      var url = "php/shopEqui.php?";
      xhr.open("Get", url, true);
      xhr.send( null );
    }//setInterval(todayEqui ,10000);
    shopEqui();

    //商城買道具增加聲量 及 買道具扣錢 商品一
    $("#addToBackpack").click(function(e){
            //--買道具增加聲量 及 買道具扣錢
            // let memNo = $('.memNo').text();                 //個人編號
            let shopPopularity = $('.shopPopularity').text();       //個人支持度
            let popularityAdd1 = $('.popularityAdd1').text(); //商品支持度
            let starCoin =$('#coin').text();                //個人金幣
            let shopSpanLogin = $('#shopSpanLogin').text();     //商品價格

            let popularityAll = parseInt(shopPopularity)+parseInt(popularityAdd1); //買道具增加聲量
            
            //==增加裝備庫欄位抓值
            let clothImg1 = $('#shopPic1').attr('src');           //商品路徑1
            let clothNo1 = $('.clothNo1').text();             //商品編號
            let clothName1 = $('.clothName1').text();  //裝備類型
            let clothClass1 = $('.clothClass1').text();       //裝備類型
            let storage = sessionStorage;
            
            console.log(clothName1);
            console.log(clothClass1);
            console.log(clothNo1);
            console.log(clothImg1);
            // console.log(memNo);
            console.log(starCoin);
            console.log(shopSpanLogin);
            
            console.log(shopPopularity);
            console.log(popularityAdd1);
            console.log(popularityAll);
            

            if(starCoin>=shopSpanLogin){
                let balance = starCoin - shopSpanLogin; //買道具扣錢
                console.log(balance);
            //--買道具增加聲量 及 買道具扣錢    
            sessionStorage.setItem('clothNo1', clothNo1);
            // sessionStorage.setItem('memNo', memNo);
            sessionStorage.setItem('starCoin', starCoin);
            sessionStorage.setItem('balance', balance);
            sessionStorage.setItem('shopSpanLogin', shopSpanLogin);
            sessionStorage.setItem('popularityAll', popularityAll);

            //==增加裝備庫欄位抓值
           
            sessionStorage.setItem('clothImg1', clothImg1);
            sessionStorage.setItem('clothClass1', clothClass1);
            sessionStorage.setItem('clothName1', clothName1);
            $.ajax({    
                url: `php/citizenShop.php`,
                data: {
                    // memNo:memNo,
                    starCoin:starCoin,
                    balance:balance,
                    shopSpanLogin:shopSpanLogin,
                    popularityAll:popularityAll,
                },
                type: 'GET',
                success: function(data){
                    // alert(1111)
                   console.log(data);
                   $('#coin').text(balance);
                   sessionStorage.setItem('starCoin',balance);
                   $('#popularity').text(popularityAll);
                   sessionStorage.setItem('popularity',popularityAll);
                },
                
            })
            
            $.ajax({    
                url: `php/ShopInsert.php`,
                data: {
                    clothNo1:clothNo1,
                    clothImg1:clothImg1,
                    clothClass1:clothClass1,
                    clothName1:clothName1,
                    // starCoin:starCoin,
                    // balance:balance,
                    // citizenShop:citizenShop,
                    // popularityAll:popularityAll,
                },
                type: 'GET',
                success: function(){
                    // alert(2222);
            
                 
                },
                
            })
        }else{
                alert("宇宙幣不足，請至公民學堂賺取宇宙幣");
            };
            
        });


        // 商城買道具增加聲量 及 買道具扣錢 商品二
        $("#addToBackpack2").click(function(e){
            //--買道具增加聲量 及 買道具扣錢
            // let memNo = $('.memNo').text();                 //個人編號
            let shopPopularity = $('.shopPopularity').text();       //個人支持度
            let popularityAdd2 = $('.popularityAdd2').text(); //商品支持度
            let starCoin =$('#coin').text();                //個人金幣
            let shopSpanLogin = $('#shopSpanLogin').text();     //商品價格

            let popularityAll = parseInt(shopPopularity)+parseInt(popularityAdd2); //買道具增加聲量
            
            //==增加裝備庫欄位抓值
            let clothImg2 = $('#shopPic2').attr('src');           //商品路徑2
            let clothNo2 = $('.clothNo2').text();             //商品編號
            let clothName2 = $('.clothName2').text();  //裝備類型
            let clothClass2 = $('.clothClass2').text();       //裝備類型
            let storage = sessionStorage;
            
            console.log(clothName2);
            console.log(clothClass2);
            console.log(clothNo2);
            console.log(clothImg2);
            // console.log(memNo);
            console.log(starCoin);
            console.log(shopSpanLogin);
            
            console.log(shopPopularity);
            console.log(popularityAdd2);
            console.log(popularityAll);
            

            if(starCoin>=shopSpanLogin){
                let balance = starCoin - shopSpanLogin; //買道具扣錢
                console.log(balance);
            //--買道具增加聲量 及 買道具扣錢    
            sessionStorage.setItem('clothNo2', clothNo2);
            // sessionStorage.setItem('memNo', memNo);
            sessionStorage.setItem('starCoin', starCoin);
            sessionStorage.setItem('balance', balance);
            sessionStorage.setItem('shopSpanLogin', shopSpanLogin);
            sessionStorage.setItem('popularityAll', popularityAll);

            //==增加裝備庫欄位抓值
           
            sessionStorage.setItem('clothImg2', clothImg2);
            sessionStorage.setItem('clothClass2', clothClass2);
            sessionStorage.setItem('clothName2', clothName2);
            $.ajax({    
                url: `php/citizenShop.php`,
                data: {
                    // memNo:memNo,
                    starCoin:starCoin,
                    balance:balance,
                    shopSpanLogin:shopSpanLogin,
                    popularityAll:popularityAll,
                },
                type: 'GET',
                success: function(data){
                    // alert(2222)
                   console.log(data);
                   $('#coin').text(balance);
                   sessionStorage.setItem('starCoin',balance);
                   $('#popularity').text(popularityAll);
                   sessionStorage.setItem('popularity',popularityAll);
                },
                
            })
            
            $.ajax({    
                url: `php/ShopInsert2.php`,
                data: {
                    clothNo2:clothNo2,
                    clothImg2:clothImg2,
                    clothClass2:clothClass2,
                    clothName2:clothName2,
                    // starCoin:starCoin,
                    // balance:balance,
                    // citizenShop:citizenShop,
                    // popularityAll:popularityAll,
                },
                type: 'GET',
                success: function(){
                    // alert(2222);
            
                 
                },
                
            })
        }else{
                alert("宇宙幣不足，請至公民學堂賺取宇宙幣");
            };
            
        });

        // 商城買道具增加聲量 及 買道具扣錢 商品三
        $("#addToBackpack3").click(function(e){
            //--買道具增加聲量 及 買道具扣錢
            // let memNo = $('.memNo').text();                 //個人編號
            let shopPopularity = $('.shopPopularity').text();       //個人支持度
            let popularityAdd3 = $('.popularityAdd3').text(); //商品支持度
            let starCoin =$('#coin').text();                //個人金幣
            let shopSpanLogin = $('#shopSpanLogin').text();     //商品價格

            let popularityAll = parseInt(shopPopularity)+parseInt(popularityAdd3); //買道具增加聲量
            
            //==增加裝備庫欄位抓值
            let clothImg3 = $('#shopPic3').attr('src');           //商品路徑3
            let clothNo3 = $('.clothNo3').text();             //商品編號
            let clothName3 = $('.clothName3').text();  //裝備類型
            let clothClass3 = $('.clothClass3').text();       //裝備類型
            let storage = sessionStorage;
            
            console.log(clothName3);
            console.log(clothClass3);
            console.log(clothNo3);
            console.log(clothImg3);
            // console.log(memNo);
            console.log(starCoin);
            console.log(shopSpanLogin);
            
            console.log(shopPopularity);
            console.log(popularityAdd3);
            console.log(popularityAll);
            

            if(starCoin>=shopSpanLogin){
                let balance = starCoin - shopSpanLogin; //買道具扣錢
                console.log(balance);
            //--買道具增加聲量 及 買道具扣錢    
            sessionStorage.setItem('clothNo3', clothNo3);
            // sessionStorage.setItem('memNo', memNo);
            sessionStorage.setItem('starCoin', starCoin);
            sessionStorage.setItem('balance', balance);
            sessionStorage.setItem('shopSpanLogin', shopSpanLogin);
            sessionStorage.setItem('popularityAll', popularityAll);

            //==增加裝備庫欄位抓值
           
            sessionStorage.setItem('clothImg3', clothImg3);
            sessionStorage.setItem('clothClass3', clothClass3);
            sessionStorage.setItem('clothName3', clothName3);
            $.ajax({    
                url: `php/citizenShop.php`,
                data: {
                    // memNo:memNo,
                    starCoin:starCoin,
                    balance:balance,
                    shopSpanLogin:shopSpanLogin,
                    popularityAll:popularityAll,
                },
                type: 'GET',
                success: function(data){
                    // alert(3333)
                   console.log(data);
                   $('#coin').text(balance);
                   sessionStorage.setItem('starCoin',balance);
                   $('#popularity').text(popularityAll);
                   sessionStorage.setItem('popularity',popularityAll);
                },
                
            })
            
            $.ajax({    
                url: `php/ShopInsert3.php`,
                data: {
                    clothNo3:clothNo3,
                    clothImg3:clothImg3,
                    clothClass3:clothClass3,
                    clothName3:clothName3,
                    // starCoin:starCoin,
                    // balance:balance,
                    // citizenShop:citizenShop,
                    // popularityAll:popularityAll,
                },
                type: 'GET',
                success: function(){
                    // alert(2222);
            
                 
                },
                
            })
        }else{
                alert("宇宙幣不足，請至公民學堂賺取宇宙幣");
            };
            
        });

        // 商城買道具增加聲量 及 買道具扣錢 商品三
        $("#addToBackpack4").click(function(e){
            //--買道具增加聲量 及 買道具扣錢
            // let memNo = $('.memNo').text();                 //個人編號
            let shopPopularity = $('.shopPopularity').text();       //個人支持度
            let popularityAdd4 = $('.popularityAdd4').text(); //商品支持度
            let starCoin =$('#coin').text();                //個人金幣
            let shopSpanLogin = $('#shopSpanLogin').text();     //商品價格

            let popularityAll = parseInt(shopPopularity)+parseInt(popularityAdd4); //買道具增加聲量
            
            //==增加裝備庫欄位抓值
            let clothImg4 = $('#shopPic4').attr('src');           //商品路徑4
            let clothNo4 = $('.clothNo4').text();             //商品編號
            let clothName4 = $('.clothName4').text();  //裝備類型
            let clothClass4 = $('.clothClass4').text();       //裝備類型
            let storage = sessionStorage;
            
            console.log(clothName4);
            console.log(clothClass4);
            console.log(clothNo4);
            console.log(clothImg4);
            // console.log(memNo);
            console.log(starCoin);
            console.log(shopSpanLogin);
            
            console.log(shopPopularity);
            console.log(popularityAdd4);
            console.log(popularityAll);
            

            if(starCoin>=shopSpanLogin){
                let balance = starCoin - shopSpanLogin; //買道具扣錢
                console.log(balance);
            //--買道具增加聲量 及 買道具扣錢    
            sessionStorage.setItem('clothNo4', clothNo4);
            // sessionStorage.setItem('memNo', memNo);
            sessionStorage.setItem('starCoin', starCoin);
            sessionStorage.setItem('balance', balance);
            sessionStorage.setItem('shopSpanLogin', shopSpanLogin);
            sessionStorage.setItem('popularityAll', popularityAll);

            //==增加裝備庫欄位抓值
           
            sessionStorage.setItem('clothImg4', clothImg4);
            sessionStorage.setItem('clothClass4', clothClass4);
            sessionStorage.setItem('clothName4', clothName4);
            $.ajax({    
                url: `php/citizenShop.php`,
                data: {
                    // memNo:memNo,
                    starCoin:starCoin,
                    balance:balance,
                    shopSpanLogin:shopSpanLogin,
                    popularityAll:popularityAll,
                },
                type: 'GET',
                success: function(data){
                    // alert(4444)
                   console.log(data);
                   $('#coin').text(balance);
                   sessionStorage.setItem('starCoin',balance);
                   $('#popularity').text(popularityAll);
                   sessionStorage.setItem('popularity',popularityAll);
                },
                
            })
            
            $.ajax({    
                url: `php/ShopInsert4.php`,
                data: {
                    clothNo4:clothNo4,
                    clothImg4:clothImg4,
                    clothClass4:clothClass4,
                    clothName4:clothName4,
                    // starCoin:starCoin,
                    // balance:balance,
                    // citizenShop:citizenShop,
                    // popularityAll:popularityAll,
                },
                type: 'GET',
                success: function(){
                    // alert(2222);
            
                 
                },
                
            })
        }else{
                alert("宇宙幣不足，請至公民學堂賺取宇宙幣");
            };
            
        });
        
    </script>
</body>
</html>